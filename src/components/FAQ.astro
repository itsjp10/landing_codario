---
const faqs = [
	{
		question: 'How fast can we launch a new landing page?',
		answer:
			'Typical timeline: 7-14 days. Day 1-2 discovery and copy draft, day 3-6 design and build, day 7 QA, day 8-10 analytics and instrumentation, day 11-14 polish and launch. Rush options available if assets or copy are ready.',
	},
	{
		question: 'Do you work with in-house teams or agencies?',
		answer:
			'Yes. We slot in as an extension of your team or partner agency-shared roadmap, GitHub repo access, and your preferred process (Sprint or Kanban). We respect your design system and code standards.',
	},
	{
		question: 'What tech stack do you use?',
		answer:
			'Frontend: Astro, Next.js, React, Tailwind, GSAP. Backend: Node.js (Express or Nest), PostgreSQL with Prisma, Supabase or Firebase. Infra: Vercel, AWS or Azure when needed. CMS: Contentful, Sanity, or your preferred headless option. Testing and QA: Playwright, Lighthouse, accessibility tools (axe). Analytics: GA4, server and client events, dashboards.',
	},
	{
		question: 'Can you support ongoing CRO and growth experiments?',
		answer:
			'Absolutely. We run A/B tests, copy and design trials, and performance experiments; set up event tracking, heatmaps, and dashboards. We propose a monthly test cadence and report on wins and learnings.',
	},
	{
		question: 'How do you ensure accessibility?',
		answer:
			'We ship to WCAG 2.1 AA: semantic HTML, keyboard navigation, focus states, color-contrast checks, descriptive alt and labels, reduced-motion support, and automated audits (axe and Lighthouse) plus manual screen-reader passes.',
	},
	{
		question: 'What if we only need engineering or design?',
		answer:
			'We can deliver engineering-only, design-only, or end-to-end. We are comfortable implementing your Figma files or creating a mini design system from scratch.',
	},
	{
		question: 'Do you handle analytics and instrumentation?',
		answer:
			'Yes. GA4 setup, consent banner, UTM standards, event schema, server and client events, funnels, and goals. We can wire Segment, Meta, and LinkedIn pixels and ship a lightweight dashboard.',
	},
	{
		question: 'How do communications run during an engagement?',
		answer:
			'Dedicated Slack or Teams channel, a single PM or lead as your point of contact, weekly demo with notes, and a shared board (Linear or Jira). SLA: same-day response on weekdays; critical issues get priority.',
	},
	{
		question: 'What happens post-launch?',
		answer:
			'30-60 days of warranty bug fixes, handoff docs, and training. Optional maintenance or growth retainer for updates, experiments, and monitoring (uptime, errors, Core Web Vitals).',
	},
	{
		question: 'Can you integrate with our existing systems?',
		answer:
			'Yes. APIs, webhooks, OAuth. Common integrations include Stripe, HubSpot or Salesforce, Auth0 or Clerk, CMSs, Zapier or Make, and internal REST or GraphQL services. We handle data migration and sandbox testing before go-live.',
	},
];

const faqSchema = {
	'@context': 'https://schema.org',
	'@type': 'FAQPage',
	mainEntity: faqs.map((faq) => ({
		'@type': 'Question',
		name: faq.question,
		acceptedAnswer: {
			'@type': 'Answer',
			text: faq.answer,
		},
	})),
};
---

<section class="bg-white py-24" id="faq">
	<div class="container max-w-4xl">
		<div class="text-center">
			<p class="text-sm font-semibold uppercase tracking-[0.32em] text-brand-dark/60">FAQ</p>
			<h2 class="mt-4 text-3xl font-semibold text-brand-dark sm:text-4xl">
				Answers to common questions about partnering with Codario Labs.
			</h2>
			<p class="mt-4 text-sm text-brand-dark/70">
				Need more details? Reach out via the contact form and we’ll share playbooks, case studies, and timelines suited to your roadmap.
			</p>
		</div>
		<div class="mt-12 divide-y divide-brand-dark/10 overflow-hidden rounded-3xl border border-brand-dark/10 bg-brand-gray/50">
			{faqs.map((faq, index) => {
				const panelId = `faq-panel-${index}`;
				const buttonId = `faq-button-${index}`;
				return (
					<div class="faq-item">
						<h3 class="sr-only">{`FAQ ${index + 1}`}</h3>
						<button
							class="flex w-full items-center justify-between gap-6 px-6 py-5 text-left text-base font-semibold text-brand-dark transition hover:bg-white focus-visible:outline-none focus-visible:ring-4 focus-visible:ring-brand-cyan/40"
							aria-expanded="false"
							aria-controls={panelId}
							id={buttonId}
							data-faq-trigger
						>
							<span>{faq.question}</span>
							<svg
								class="h-5 w-5 flex-none text-brand-dark/50 transition-transform duration-200 ease-out"
								data-faq-icon
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="1.6"
							>
								<path d="M12 5v14" stroke-linecap="round" />
								<path d="M5 12h14" stroke-linecap="round" />
							</svg>
						</button>
						<div
							id={panelId}
							role="region"
							aria-labelledby={buttonId}
							class="hidden border-t border-brand-dark/10 bg-white/80 px-6 py-4 text-sm leading-relaxed text-brand-dark/70"
						>
							{faq.answer}
						</div>
					</div>
				);
			})}
		</div>
	</div>
</section>

<script type="application/ld+json" is:inline>{JSON.stringify(faqSchema)}</script>

<script type="module" is:inline>
	const setupFaq = () => {
		const items = document.querySelectorAll('[data-faq-trigger]');
		items.forEach((button) => {
			const panelId = button.getAttribute('aria-controls');
			const panel = panelId ? document.getElementById(panelId) : null;
			const icon = button.querySelector('[data-faq-icon]');
			if (!panel) return;

			button.addEventListener('click', () => {
				const expanded = button.getAttribute('aria-expanded') === 'true';
				button.setAttribute('aria-expanded', String(!expanded));
				panel.classList.toggle('hidden', expanded);
				if (!expanded) {
					panel.classList.remove('animate-faq');
					// trigger reflow for re-animating
					void panel.offsetWidth;
					panel.classList.add('animate-faq');
				} else {
					panel.classList.remove('animate-faq');
				}
				if (icon) {
					icon.classList.toggle('rotate-45', !expanded);
					icon.classList.toggle('text-brand-cyan', !expanded);
				}
			});

			panel.addEventListener('animationend', () => {
				panel.classList.remove('animate-faq');
			});
		});
	};

	if (document.readyState === 'complete' || document.readyState === 'interactive') {
		setupFaq();
	} else {
		document.addEventListener('DOMContentLoaded', setupFaq, { once: true });
	}

	document.addEventListener('astro:page-load', setupFaq);
</script>

<style is:global>
	@keyframes faq-reveal {
		from {
			opacity: 0;
			transform: translateY(-8px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.animate-faq {
		animation: faq-reveal 240ms cubic-bezier(0.16, 1, 0.3, 1);
	}
</style>
